<div style="max-width: 600px; margin: 0 auto; padding: 20px; font-family: sans-serif;">
  <h1 style="text-align: center; color: #333;">ÊäïÁ®ø</h1>

  <div style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background-color: #fdfdfd;">
    <%= form_with model: @post, local: true do |f| %>
      <%= f.text_area :content, placeholder: "„ÅÑ„Åæ„Å©„ÅÜ„Åó„Å¶„ÇãÔºü", style: "width: 100%; height: 80px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; resize: none;" %>
      
      <div style="margin-top: 10px;">
        <label style="font-size: 0.8rem; color: #666; display: block; margin-bottom: 5px;">ÂÜôÁúü„ÇíÊäïÁ®ø„Åô„Çã</label>
        <%= f.file_field :image, accept: "image/*" %>
      </div>

      <div style="text-align: right; margin-top: 10px;">
        <%= f.submit "ÊäïÁ®ø„Åô„Çã", style: "background-color: #007bff; color: white; border: none; padding: 8px 20px; border-radius: 20px; cursor: pointer; font-weight: bold;" %>
      </div>
    <% end %>
  </div>

  <div>
    <% @posts.each do |post| %>
      <div style="border-bottom: 1px solid #eee; padding: 15px 0; display: flex; gap: 15px;">
        <div>
          <% if post.user.profile_image.attached? %>
            <%= image_tag post.user.profile_image, style: "width: 50px; height: 50px; border-radius: 50%; object-fit: cover;" %>
          <% else %>
            <div style="width: 50px; height: 50px; border-radius: 50%; background-color: #eee; text-align: center; line-height: 50px; color: #999; font-size: 0.8rem;">No Image</div>
          <% end %>
        </div>

        <div style="flex: 1;">
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <span style="font-weight: bold;">
              <%= link_to (post.user.nickname.presence || post.user.email), user_path(post.user), style: "text-decoration: none; color: #333;" %>
            </span>
            <span style="font-size: 0.8rem; color: #999;">
              <%= post.created_at.strftime("%Y/%m/%d %H:%M") %>
            </span>
          </div>
          
          <p style="margin: 10px 0; line-height: 1.4; color: #444;">
            <%= post.content %>
          </p>

          <%# ÁîªÂÉè„ÅÆË°®Á§∫ %>
          <% if post.image.attached? %>
            <div style="margin: 10px 0;">
              <%= image_tag post.image, style: "max-width: 100%; max-height: 400px; border-radius: 8px; border: 1px solid #eee; display: block;" %>
            </div>
          <% end %>

          <div style="display: flex; align-items: center; gap: 20px; margin-top: 10px;">
            
            <% if post.user != current_user %>
              <div style="display: flex; align-items: center; gap: 5px;">
                <% if post.likes.find_by(user_id: current_user.id) %>
                  <%= button_to post_likes_path(post), method: :delete, form: { data: { turbo: false } }, style: "background: none; border: none; cursor: pointer; font-size: 1.1rem; padding: 0;" do %>
                    <span style="color: #ff4d4d;">‚ù§Ô∏è</span>
                  <% end %>
                <% else %>
                  <%= button_to post_likes_path(post), method: :post, form: { data: { turbo: false } }, style: "background: none; border: none; cursor: pointer; font-size: 1.1rem; padding: 0;" do %>
                    <span style="color: #ccc;">ü§ç</span>
                  <% end %>
                <% end %>
                <%= link_to liked_users_post_path(post), style: "text-decoration: none; color: #666; font-size: 0.9rem;" do %>
                  <%= post.likes.count %>
                <% end %>
              </div>
            <% else %>
              <div style="display: flex; align-items: center; gap: 5px;">
                <span style="font-size: 1.1rem;">‚ù§Ô∏è</span>
                <%= link_to liked_users_post_path(post), style: "text-decoration: none; color: #666; font-size: 0.9rem;" do %>
                  <%= post.likes.count %>
                <% end %>
              </div>
            <% end %>

            <% if post.user == current_user %>
              <%= link_to "Á∑®ÈõÜ", edit_post_path(post), style: "font-size: 0.8rem; color: #007bff; text-decoration: none;" %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>