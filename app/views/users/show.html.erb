<div style="max-width: 600px; margin: 2rem auto; padding: 0 20px;">
  <div style="background: white; border: 1px solid var(--border-color); border-radius: 16px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.02);">
    
    <div style="height: 120px; background: linear-gradient(to right, #e1e8ed, #f7f9f9);"></div>

    <div style="padding: 0 20px 20px; position: relative; margin-top: -60px;">
      <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 15px;">
        <% if @user.profile_image.attached? %>
          <%= image_tag @user.profile_image, style: "width: 120px; height: 120px; border-radius: 50%; border: 4px solid white; object-fit: cover; background: white;" %>
        <% else %>
          <div style="width: 120px; height: 120px; border-radius: 50%; border: 4px solid white; background: #ccc; display: flex; align-items: center; justify-content: center; font-size: 3rem;">ðŸ‘¤</div>
        <% end %>

        <div style="display: flex; gap: 8px; margin-bottom: 10px;">
          <% if @user == current_user %>
            <%= link_to "ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†", edit_user_path(@user), style: "border: 1px solid var(--border-color); color: var(--text-main); padding: 8px 16px; border-radius: 99px; text-decoration: none; font-weight: bold; font-size: 0.9rem;" %>
            <%# --- ã“ã“ã«ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒœã‚¿ãƒ³ã‚’è¨­ç½® --- %>
            <%= link_to "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ", logout_path, data: { turbo_method: :get }, style: "border: 1px solid #ffdada; color: var(--danger-color); padding: 8px 16px; border-radius: 99px; text-decoration: none; font-weight: bold; font-size: 0.9rem; background: #fff5f5;" %>
          <% else %>
            <% if @isRoom %>
              <%= link_to "âœ‰ï¸", room_path(@roomId), style: "border: 1px solid var(--border-color); padding: 8px 12px; border-radius: 50%; text-decoration: none; font-size: 1.1rem;" %>
            <% else %>
              <%= form_with model: @room, local: true, style: "display: inline;" do |f| %>
                <%= fields_for @entry do |e| %> <%= e.hidden_field :user_id, value: @user.id %> <% end %>
                <%= f.button "âœ‰ï¸+", type: :submit, style: "background: white; border: 1px solid var(--border-color); padding: 8px 12px; border-radius: 50%; cursor: pointer; font-size: 1.1rem;" %>
              <% end %>
            <% end %>
            <% if current_user.following?(@user) %>
              <%= button_to "ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤", user_relationships_path(@user), method: :delete, form: {data: {turbo: false}}, style: "background: #0f1419; color: white; border: none; padding: 8px 16px; border-radius: 99px; cursor: pointer; font-weight: bold; font-size: 0.9rem;" %>
            <% else %>
              <%= button_to "ãƒ•ã‚©ãƒ­ãƒ¼", user_relationships_path(@user), method: :post, form: {data: {turbo: false}}, style: "background: var(--primary-color); color: white; border: none; padding: 8px 16px; border-radius: 99px; cursor: pointer; font-weight: bold; font-size: 0.9rem;" %>
            <% end %>
          <% end %>
        </div>
      </div>

      <h2 style="margin: 0; font-size: 1.4rem; font-weight: 900;"><%= @user.nickname.presence || @user.email %></h2>
      <p style="color: var(--text-sub); margin: 4px 0 15px;"><%= @user.email %></p>
      
      <p style="white-space: pre-wrap; font-size: 0.95rem; line-height: 1.6; margin-bottom: 15px;">
        <%= @user.introduction.presence || "è‡ªå·±ç´¹ä»‹ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚" %>
      </p>

      <div style="display: flex; gap: 20px; color: var(--text-sub); font-size: 0.9rem;">
        <%= link_to following_user_path(@user), style: "text-decoration: none; color: inherit;" do %>
          <span><strong><%= @user.following.count %></strong> ãƒ•ã‚©ãƒ­ãƒ¼ä¸­</span>
        <% end %>
        
        <%= link_to followers_user_path(@user), style: "text-decoration: none; color: inherit;" do %>
          <span><strong><%= @user.followers.count %></strong> ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼</span>
        <% end %>
      </div>
    </div>
  </div>

  <h3 style="margin: 30px 0 15px; font-size: 1.2rem; font-weight: 800; border-bottom: 2px solid var(--primary-color); display: inline-block;">æŠ•ç¨¿</h3>
  <% @posts.each do |post| %>
    <div style="background: white; border: 1px solid var(--border-color); border-radius: 12px; padding: 16px; margin-bottom: 12px;">
      <p style="margin: 0 0 8px;"><%= render_with_hashtags(post.content) %></p>
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <small style="color: var(--text-sub);"><%= post.created_at.strftime("%Y/%m/%d %H:%M") %></small>
        <%= link_to "è©³ç´°", post_path(post), style: "text-decoration:none; color:var(--primary-color); font-size:0.8rem;" %>
      </div>
    </div>
  <% end %>
</div>